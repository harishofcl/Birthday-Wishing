/* ===== Base helpers & overlay visibility fixes (put first) ===== */
.hidden { display: none !important; visibility: hidden !important; pointer-events: none !important; }

/* Hide modal & collect overlay until opened */
.modal-slideshow { display:none; position:fixed; inset:0; z-index:12000; align-items:center; justify-content:center; }
.modal-slideshow.open { display:flex; background: linear-gradient(180deg, rgba(2,4,10,0.85), rgba(2,6,20,0.95)); }
.modal-slideshow .controls-row { display:none; }
.modal-slideshow.open .controls-row { display:flex; gap:10px; align-items:center; justify-content:center; }

.collect-overlay { display:none; }
.collect-overlay.open { display:flex; align-items:center; justify-content:center; }

/* ===== Theme & background ===== */
:root{
  --bg1-start: #ff9a9e;
  --bg1-end: #fad0c4;
  --glass-bg: rgba(255,255,255,0.06);
  --glass-border: rgba(255,255,255,0.12);
  --accent1: #ff7aa2;
  --accent2: #ffd47a;
  --muted: rgba(255,255,255,0.85);
  --maxWidth: 1200px;
}

*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
  background: linear-gradient(135deg, var(--bg1-start), var(--bg1-end));
  color:#fff;
  -webkit-font-smoothing:antialiased;
}

/* Slight zoom-out on very small screens until user confirms */
@media (max-width:420px){
  body:not(.zoom-ok){
    transform: scale(0.96);
    transform-origin: top center;
  }
}

/* ===== Layout elements ===== */
/* Side notes */
.side-note{position:fixed;top:12%;width:200px;z-index:40;pointer-events:none}
.left-note{left:14px;transform:rotate(-5deg)}
.right-note{right:14px;transform:rotate(4deg)}
.side-note .note-inner{background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));border-radius:10px;padding:14px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 12px 40px rgba(0,0,0,0.6);color:var(--muted);width:100%}
.side-note h4{margin:0 0 6px 0;font-family:'Short Stack',cursive;color:var(--accent1)}
.side-note p{margin:0;font-size:13px;color:rgba(255,255,255,0.78)}

/* decorative heart */
.heart.decorative-heart{
  width:120px;height:120px;border-radius:50%;
  left:8%;top:14%;position:fixed;
  background: linear-gradient(135deg,var(--accent1),var(--accent2));
  box-shadow: 0 10px 30px rgba(255,122,162,0.12);
  z-index:30;pointer-events:none;
}

/* guide + dropbox */
.paper-guide{
  position:fixed;left:50%;top:auto;bottom:8%;
  transform:translateX(-50%);width:86%;max-width:460px;
  display:flex;flex-direction:column;gap:8px;align-items:center;z-index:40;pointer-events:auto;
}
.paper-guide .guide-text{background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);color:rgba(255,255,255,0.95);font-weight:600;width:100%;text-align:center;box-shadow: 0 10px 24px rgba(0,0,0,0.35);}

/* DROP BOX */
.dropbox {
  width: 220px; max-width: 86%; height: 84px;
  background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
  border-radius: 12px; display:flex;align-items:center;justify-content:center;
  border: 2px dashed rgba(255,255,255,0.08); color: rgba(255,255,255,0.92); font-weight:800; font-size:0.98rem;
  box-shadow: 0 10px 30px rgba(0,0,0,0.35); transition: transform 160ms ease, border-color 160ms ease, background 160ms ease, opacity 200ms; z-index:41;
}
.dropbox.active { transform: translateY(-6px) scale(1.02); border-color: rgba(255,255,255,0.22); background: linear-gradient(90deg, rgba(255,122,162,0.14), rgba(255,212,122,0.10)); }

@media (max-width:920px){
  .paper.glass{width:260px;min-height:200px}
  .side-note{display:none}
  .paper-guide{width:92%}
  .dropbox{width:200px;height:72px}
}

/* Paper base */
.paper{width:280px;min-height:180px;position:absolute;left:50%;top:60%;transform:translateX(-50%) translateY(-50%) rotateZ(0deg);border-radius:14px;cursor:grab;user-select:none;z-index:10;transition:box-shadow .18s ease}

/* Glass card */
.paper.glass{width:360px;min-height:260px;background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));border: 1px solid var(--glass-border);backdrop-filter: blur(8px) saturate(120%);box-shadow: 0 18px 50px rgba(2,6,23,0.6);overflow: hidden;display:flex;align-items:flex-end}
.glass-photo{position:relative;width:100%;height:100%;display:flex;flex-direction:column;justify-content:flex-end}
.glass-photo img{width:100%;height:72%;object-fit:cover;display:block}
.glass-caption{padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))}
.cap-title{font-weight:800;color:#fff;font-size:16px}
.cap-sub{font-size:13px;color:rgba(255,255,255,0.82);margin-top:6px}
.paper:hover{box-shadow:0 30px 80px rgba(2,6,23,0.7);transform:scale(1.02)}

/* collected badge */
.collected-badge{position:absolute;top:8px;right:10px;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#111;padding:6px 8px;border-radius:999px;font-weight:700;font-size:12px;box-shadow:0 8px 20px rgba(0,0,0,0.45)}

/* modal & pages */
.modal-card{width:min(var(--maxWidth),96%);max-height:86vh;overflow:hidden;display:grid;grid-template-columns:1fr 360px;gap:14px;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03);align-items:center}
.modal-pages{width:100%;height:100%;display:grid;grid-template-rows:1fr auto;gap:12px;align-items:stretch}
.page-stage{display:flex;align-items:center;justify-content:center;gap:18px;padding:18px}
.page{width:100%;max-width:820px;height:72vh;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));border-radius:12px;display:flex;align-items:center;justify-content:center;flex-direction:row;gap:18px;padding:18px;box-shadow:0 10px 40px rgba(0,0,0,0.45);overflow:hidden;opacity:0;transform:translateY(10px) scale(.995);transition:opacity .5s ease, transform .6s cubic-bezier(.2,.9,.3,1)}
.page.active{opacity:1;transform:translateY(0) scale(1)}
.page .photo{flex:1;display:flex;align-items:center;justify-content:center}
.page .photo img{max-width:100%;max-height:72vh;object-fit:contain;border-radius:10px}
.page .text{width:360px;padding:12px;display:flex;flex-direction:column;gap:8px;justify-content:center}
.page .title{font-size:20px;font-weight:800;margin:0;color:#fff}
.page .desc{color:rgba(255,255,255,0.88);font-size:16px;line-height:1.4;min-height:76px}
.controls-row{display:flex;gap:10px;align-items:center;justify-content:center;padding:12px}
.page-progress{height:8px;background:rgba(255,255,255,0.06);border-radius:999px;overflow:hidden;width:60%}
.page-progress>i{display:block;height:100%;background:linear-gradient(90deg,var(--accent1),var(--accent2));width:0%;transition:width linear}
.page-nav{padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
.page-nav.ghost{background:transparent;border:1px solid rgba(255,255,255,0.08);color:#fff}
.page-nav.primary{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#111}
.page-dots{display:flex;gap:8px;align-items:center;justify-content:center}
.page-dots .dot{width:10px;height:10px;border-radius:50%;background:rgba(255,255,255,0.12)}
.page-dots .dot.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));box-shadow:0 4px 12px rgba(255,122,162,0.22)}
.typewriter{white-space:pre-wrap;font-family:inherit;position:relative}
.typewriter::after{content:'';display:inline-block;width:2px;height:1.05em;background:#fff;margin-left:6px;vertical-align:middle;animation:blinkCaret 900ms steps(1) infinite}
@keyframes blinkCaret{50%{opacity:0}}
.dimmed{filter:blur(2px) brightness(.8);transition:filter .36s ease}
.dimmed-hide{visibility:hidden !important; opacity:0 !important; pointer-events:none}

/* final readability tweaks */
.page { position: relative; }
.page::before { content:""; position:absolute; inset:0; background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.45)); z-index:1; pointer-events:none; }
.page .intro-text-wrap, .page .text-wrap, .page .photo, .page .text, .page .desc, .page .intro-desc { position:relative; z-index:2; color:#fff; text-shadow:0 6px 18px rgba(0,0,0,0.6); }

/* responsive final improvements */
@media (max-width: 600px) {
  .page::before { background: linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.6)); }
  .page.intro-text-page .intro-title, .page.text-bg .text-title { font-size: 24px !important; }
  .page .desc, .page .intro-desc, .page .text-desc { font-size: 16px !important; line-height:1.4 !important; }
  .page .photo img { max-height: 50vh; object-fit: cover; }
}

/* small drag hint */
.drag-hint{ position:fixed; left:50%; bottom:18%; transform:translateX(-50%); background: linear-gradient(90deg,var(--accent1),var(--accent2)); color:#111; padding:8px 12px; border-radius:999px; font-weight:700; z-index:40000; box-shadow: 0 10px 30px rgba(0,0,0,0.45); }
